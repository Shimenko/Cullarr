<% content_for :title, "UI Styleguide" %>

<div class="space-y-6">
  <%= render Ui::PanelComponent.new(title: "UI Primitive Styleguide", subtitle: "Development and test only") do %>
    <p class="ui-copy">
      This catalog shows canonical component APIs and state coverage for Slice 2B.
      Use these primitives in feature views instead of ad-hoc class strings.
    </p>
  <% end %>

  <%= render Ui::PanelComponent.new(title: "Buttons", subtitle: "Variants, sizes, and icon placement") do %>
    <div class="space-y-4">
      <div class="flex flex-wrap items-center gap-3">
        <%= render Ui::ButtonComponent.new(label: "Primary", variant: :primary) %>
        <%= render Ui::ButtonComponent.new(label: "Secondary", variant: :secondary) %>
        <%= render Ui::ButtonComponent.new(label: "Ghost", variant: :ghost) %>
        <%= render Ui::ButtonComponent.new(label: "Danger", variant: :danger, icon: "trash-2") %>
        <%= render Ui::ButtonComponent.new(label: "Link", variant: :link) %>
      </div>

      <div class="flex flex-wrap items-center gap-3">
        <%= render Ui::ButtonComponent.new(label: "Small", size: :sm) %>
        <%= render Ui::ButtonComponent.new(label: "Default", size: :md) %>
        <%= render Ui::ButtonComponent.new(label: "Large", size: :lg, icon: "loader", icon_position: :trailing) %>
        <%= render Ui::ButtonComponent.new(label: "Disabled", disabled: true, variant: :secondary) %>
        <%= render Ui::ButtonComponent.new(label: "Loading", disabled: true, variant: :secondary, icon: "loader") %>
        <%= render Ui::ButtonComponent.new(label: "Settings Link", href: settings_path, variant: :secondary) %>
      </div>

      <div class="flex flex-wrap items-center gap-3">
        <%= render Ui::IconButtonComponent.new(icon: "info", aria_label: "Information") %>
        <%= render Ui::IconButtonComponent.new(icon: "trash-2", aria_label: "Delete candidate", variant: :danger) %>
        <%= render Ui::IconButtonComponent.new(icon: "loader", aria_label: "Refreshing", disabled: true) %>
      </div>
    </div>
  <% end %>

  <%= render Ui::PanelComponent.new(title: "Chips and Badges", subtitle: "Risk and blocker semantics") do %>
    <div class="space-y-4">
      <div class="flex flex-wrap items-center gap-2">
        <%= render Ui::ChipComponent.new(label: "Neutral", kind: :neutral) %>
        <%= render Ui::ChipComponent.new(label: "Radarr:4K", kind: :instance) %>
        <%= render Ui::ChipComponent.new(label: "Multi-version", kind: :risk, icon: "triangle-alert") %>
        <%= render Ui::ChipComponent.new(label: "In progress", kind: :blocker, icon: "circle-x") %>
      </div>

      <div class="flex flex-wrap items-center gap-2">
        <%= render Ui::BadgeComponent.new(label: "Queued", kind: :neutral) %>
        <%= render Ui::BadgeComponent.new(label: "Healthy", kind: :success, icon: "circle-check") %>
        <%= render Ui::BadgeComponent.new(label: "Warning", kind: :warning, icon: "triangle-alert") %>
        <%= render Ui::BadgeComponent.new(label: "Failed", kind: :danger, icon: "circle-x") %>
        <%= render Ui::BadgeComponent.new(label: "Info", kind: :info, icon: "info") %>
      </div>
    </div>
  <% end %>

  <%= render Ui::PanelComponent.new(title: "Inline Alerts", subtitle: "Shared flash and inline messaging") do %>
    <div class="space-y-3">
      <%= render Ui::InlineAlertComponent.new(kind: :info, message: "Sync queued. New progress updates will stream live.") %>
      <%= render Ui::InlineAlertComponent.new(kind: :success, message: "Integration check completed successfully.") %>
      <%= render Ui::InlineAlertComponent.new(kind: :warning, message: "Compatibility warning: destructive operations are blocked.") %>
      <%= render Ui::InlineAlertComponent.new(kind: :danger, title: "Delete blocked", message: "Candidate is still in progress for one or more selected users.") %>
    </div>
  <% end %>

  <%= render Ui::PanelComponent.new(title: "Form Controls", subtitle: "Input, select, checkbox, and switch") do %>
    <div class="grid gap-4 md:grid-cols-2">
      <%= render Ui::InputComponent.new(
        name: "integration[name]",
        label: "Integration Name",
        value: "Radarr (4K)",
        help_text: "Displayed in chips and health panels"
      ) %>

      <%= render Ui::InputComponent.new(
        name: "integration[base_url]",
        label: "Base URL",
        value: "https://radarr.local",
        error_text: "Must be a valid http or https URL"
      ) %>

      <%= render Ui::SelectComponent.new(
        name: "integration[kind]",
        label: "Integration Kind",
        options: @select_options,
        selected: "radarr",
        include_blank: "Select integration"
      ) %>

      <%= render Ui::SelectComponent.new(
        name: "settings[watch_mode]",
        label: "Watch Mode",
        options: [ [ "Play count", "play_count" ], %w[Percent percent] ],
        selected: "play_count",
        help_text: "Percent mode requires duration and offset metadata"
      ) %>

      <%= render Ui::CheckboxComponent.new(
        name: "settings[sync_enabled]",
        label: "Enable background sync",
        checked: true,
        help_text: "When disabled, manual sync remains available"
      ) %>

      <%= render Ui::SwitchComponent.new(
        name: "settings[image_cache_enabled]",
        label: "Cache proxied images",
        checked: false
      ) %>
    </div>
  <% end %>

  <%= render Ui::PanelComponent.new(title: "Progress", subtitle: "Run and phase status") do %>
    <div class="space-y-4">
      <%= render Ui::ProgressComponent.new(value: 22, max: 100, label: "Sync Run", animated: true) %>
      <%= render Ui::ProgressComponent.new(value: 4, max: 12, label: "Deletion Actions", caption: "4 / 12 confirmed", variant: :warning) %>
      <%= render Ui::ProgressComponent.new(value: 12, max: 12, label: "Cleanup", caption: "Complete", variant: :success) %>
    </div>
  <% end %>

  <%= render Ui::PanelComponent.new(title: "Interaction Controllers", subtitle: "Hold-to-confirm, copy feedback, and row expansion behavior") do %>
    <div class="grid gap-4 md:grid-cols-3">
      <section>
        <p class="ui-copy mb-2">Hold to confirm</p>
        <button
          type="button"
          class="ui-button ui-button-danger ui-hold-confirm"
          data-controller="hold-to-confirm"
          data-hold-to-confirm-duration-value="320"
          data-hold-to-confirm-confirmed-text-value="Confirmed"
          data-action="pointerdown->hold-to-confirm#start pointerup->hold-to-confirm#cancel pointerleave->hold-to-confirm#cancel pointercancel->hold-to-confirm#cancel mousedown->hold-to-confirm#start mouseup->hold-to-confirm#cancel mouseleave->hold-to-confirm#cancel touchstart->hold-to-confirm#start touchend->hold-to-confirm#cancel keydown->hold-to-confirm#start keyup->hold-to-confirm#cancel blur->hold-to-confirm#cancel"
          data-testid="hold-to-confirm-demo"
          aria-label="Hold to confirm delete preview"
          aria-valuemin="0"
          aria-valuemax="100"
          aria-valuenow="0">
          <span class="ui-hold-confirm-progress" data-hold-to-confirm-target="progress"></span>
          <span class="ui-button-label" data-hold-to-confirm-target="label">Hold to confirm</span>
        </button>
      </section>

      <section data-controller="copy-to-clipboard" data-copy-to-clipboard-reset-delay-value="1000">
        <p class="ui-copy mb-2">Copy to clipboard</p>
        <div class="space-y-2">
          <input
            type="text"
            class="ui-control ui-text-body-sm"
            data-copy-to-clipboard-target="source"
            value="/media/movies/example.movie.mkv"
            readonly="readonly"
            autocomplete="off">
          <%= render Ui::ButtonComponent.new(
            label: "Copy path",
            variant: :secondary,
            type: :button,
            data: { action: "copy-to-clipboard#copy", testid: "copy-to-clipboard-demo" }
          ) %>
          <p class="ui-copy-feedback" data-copy-to-clipboard-target="feedback">
            Press copy to get immediate status feedback.
          </p>
        </div>
      </section>

      <section
        class="rounded-lg border ui-border p-3 ui-hover-row"
        data-controller="row-expand"
        data-row-expand-expanded-value="false"
        data-testid="row-expand-demo">
        <p class="ui-copy mb-2">Row expansion</p>
        <button
          type="button"
          class="ui-button ui-button-secondary"
          data-row-expand-target="toggle"
          data-action="click->row-expand#toggle keydown->row-expand#toggle"
          data-testid="row-expand-toggle"
          aria-controls="row-expand-content-demo"
          aria-expanded="false">
          Toggle details
        </button>
        <div
          id="row-expand-content-demo"
          class="ui-row-expand-content"
          data-row-expand-target="content"
          hidden="hidden">
          Expanded row details remain server-truthful; Stimulus only controls the disclosure state.
        </div>
      </section>
    </div>
  <% end %>

  <%= render Ui::PanelComponent.new(title: "Usage Notes", subtitle: "Stable initializer contract") do %>
    <ul class="list-disc space-y-1 pl-5 ui-copy">
      <li>Use keyword arguments only and inherit from <code>Ui::BaseComponent</code>.</li>
      <li>Validate variants and booleans in initializers with the shared option helpers.</li>
      <li>Prefer these primitives over copying one-off button or alert markup into feature templates.</li>
      <li>Keep icons to the Lucide set in <code>app/assets/icons/lucide</code>.</li>
    </ul>
  <% end %>
</div>
